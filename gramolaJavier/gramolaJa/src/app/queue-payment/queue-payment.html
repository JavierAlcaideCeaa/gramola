<div class="modal-overlay" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    
    <!-- Header -->
    <div class="modal-header">
      <h2>ğŸµ Pagar para Encolar</h2>
      <button class="close-btn" (click)="closeModal()">âœ•</button>
    </div>
    
    <!-- Track Info -->
    <div class="track-info" *ngIf="track">
      <img [src]="track.album.images[0]?.url" alt="Album cover">
      <div class="track-details">
        <p class="track-name">{{ track.name }}</p>
        <p class="track-artist">{{ track.artists[0].name }}</p>
      </div>
    </div>
    
    <!-- Nombre del cliente -->
    <div class="form-group" *ngIf="!showStripeForm">
      <label>ğŸ‘¤ Tu Nombre</label>
      <input 
        type="text" 
        [(ngModel)]="customerName" 
        placeholder="Ingresa tu nombre"
        maxlength="50"
        class="name-input">
    </div>
    
    <!-- Precio Fijo -->
    <div class="price-display" *ngIf="!showStripeForm">
      <div class="price-card-fixed">
        <span class="price-amount">{{ selectedPrice === 199 ? '1.99â‚¬' : '2.99â‚¬' }}</span>
        <span class="price-label">{{ selectedPrice === 199 ? 'âš¡ Adelantar en la cola' : 'ğŸµ AÃ±adir canciÃ³n nueva' }}</span>
      </div>
    </div>
    
    <!-- BotÃ³n de Pago Inicial -->
    <button 
      *ngIf="!showStripeForm"
      class="pay-btn" 
      (click)="processPayment()"
      [disabled]="loading">
      {{ loading ? 'â³ Preparando...' : 'ğŸ’³ Pagar ' + (selectedPrice === 199 ? '1.99â‚¬' : '2.99â‚¬') }}
    </button>
    
    <!-- Formulario de Stripe -->
    <div class="stripe-form" *ngIf="showStripeForm">
      <h3>ğŸ’³ InformaciÃ³n de Pago</h3>
      <div id="queue-card-element" class="card-element"></div>
      <div id="queue-card-error" class="card-error"></div>
      
      <button 
        class="pay-btn" 
        (click)="confirmPayment()"
        [disabled]="loading">
        {{ loading ? 'â³ Procesando...' : 'âœ… Confirmar Pago' }}
      </button>
    </div>
    
    <!-- Stripe Badge -->
    <div class="stripe-badge">
      <span>ğŸ”’</span>
      <span>Pago seguro con Stripe</span>
    </div>
    
  </div>
</div>